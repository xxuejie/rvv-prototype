// extern crate alloc;
// use alloc::format;
// use ckb_std::syscalls::debug;

use super::{
    constants::*,
    curve::{self, CurvePoint},
    gfp, gfp12, gfp2, gfp6,
    miller::*,
    twist::{self, TwistPoint},
};
use core::mem::size_of;

pub fn entry() {
    test_memory_alignments();
    test_constants();
    test_mul_by_byte_index();
    test_add_by_byte_index();
    // TODO: revise those tests later based on ethereum specific curves
    // test_miller_mulline2();
    // test_multi_batch_gfp_mul();
    // test_gfp_mul_with_carry();
    // test_gfp_add();
    // test_gfp_sub();
    // test_gfp_sub_with_carry();
    // test_gfp_neg();
    // test_gfp_invert();
    // test_gfp_sqrt();
    // test_gfp_mont_encode_decode();
    // test_gfp_mont_encode2();
    // test_gfp2_conjugate();
    // test_gfp2_mul();
    // test_gfp2_mul_scalar();
    // test_gfp2_mul_xi();
    // test_gfp2_square();
    // test_gfp2_invert();
    // test_gfp6_mul();
    // test_gfp6_add();
    // test_gfp6_mul_tau();
    // test_gfp6_frobenius();
    // test_gfp6_square();
    // test_gfp6_invert();
    // test_gfp12_mul();
    // test_gfp12_conjugate();
    // test_gfp12_frobenius();
    // test_gfp12_square();
    // test_gfp12_set_one();
    // test_gfp12_exp();
    // test_gfp12_invert();
    // test_gfp12_final_exponentiation();
    // test_curve_point_add();
    // test_curve_point_double();
    // test_curve_make_affine();
    // test_twist_make_affine();
    // test_twist_double();
    // test_twist_add();
    // test_miller_line_function_add();
    // test_miller_line_function_double();
    // test_miller_mul_line();
    // test_miller();
}

pub fn test_memory_alignments() {
    assert_eq!(size_of::<gfp::Gfp>(), 32);
    assert_eq!(size_of::<gfp2::Gfp2>(), 64);
    assert_eq!(size_of::<gfp6::Gfp6>(), 192);
    assert_eq!(size_of::<gfp12::Gfp12>(), 384);
    assert_eq!(size_of::<[gfp::Gfp; 64]>(), 32 * 64);
    assert_eq!(size_of::<[gfp2::Gfp2; 8]>(), 64 * 8);
    assert_eq!(size_of::<[gfp6::Gfp6; 15]>(), 192 * 15);
    assert_eq!(size_of::<[gfp12::Gfp12; 3]>(), 384 * 3);
}

pub fn test_multi_batch_gfp_mul() {
    let a = gfp::Gfp([
        11250488846250692438,
        4656389213572280514,
        123,
        8950588588633063607,
    ]);
    let b = gfp::Gfp([
        1755467536201717349,
        17175472035685840286,
        12281294985516866593,
        10355184993929758713,
    ]);

    let aa: [gfp::Gfp; 53] = [
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
        a.clone(),
    ];

    let bb: [gfp::Gfp; 53] = [
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
        b.clone(),
    ];

    let mut cc: [gfp::Gfp; 53] = [
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
        gfp::Gfp::default(),
    ];

    gfp::mul(&aa, &bb, &mut cc);

    let c = gfp::Gfp([
        15559124068522268778,
        4388294418392014253,
        13026942575419976433,
        9224681250169400588,
    ]);

    for i in 0..53 {
        assert_eq!(cc[i], c);
    }
}

pub fn test_constants() {
    assert_eq!(gfp::ONE, gfp::Gfp::new_from_int64(1));
    assert_eq!(gfp::ZERO, gfp::Gfp::new_from_int64(0));
    assert_eq!(curve::CURVE_B, [gfp::Gfp::new_from_int64(3)]);
    assert_eq!(
        curve::CURVE_GEN,
        curve::CurvePoint([
            gfp::Gfp::new_from_int64(1),
            gfp::Gfp::new_from_int64(2),
            gfp::Gfp::new_from_int64(1),
            gfp::Gfp::new_from_int64(1),
        ])
    );
    assert_eq!(twist::TWIST_GEN.z().x(), &gfp::Gfp::new_from_int64(0),);
    assert_eq!(twist::TWIST_GEN.z().y(), &gfp::Gfp::new_from_int64(1),);
    assert_eq!(twist::TWIST_GEN.t().x(), &gfp::Gfp::new_from_int64(0),);
    assert_eq!(twist::TWIST_GEN.t().y(), &gfp::Gfp::new_from_int64(1),);
}

pub fn test_gfp_mul_with_carry() {
    let a = gfp::Gfp([
        0x9c21c3ff7e444f56,
        0x409ed151b2efb0c2,
        0x7c36e0e62c2380b7,
        0xFFFFFFFFFFFFFFFE,
    ]);
    let b = gfp::Gfp([
        0x185cac6c5e089665,
        0xee5b88d120b5b59e,
        0xaa6fecb86184dc21,
        0xFFFFFFFFFFFFFFFE,
    ]);

    let c = a * b;

    assert_eq!(
        c,
        gfp::Gfp([
            8285319100095743200,
            10296293173922742217,
            6548902816963158894,
            10996926879179715675,
        ])
    );
}

pub fn test_gfp_add() {
    let a = gfp::Gfp([
        11250488846250692438,
        4656389213572280514,
        123,
        8950588588633063607,
    ]);
    let b = gfp::Gfp([
        1755467536201717349,
        17175472035685840286,
        213721987,
        10355184993929758713,
    ]);

    let c = a + b;

    assert_eq!(
        c,
        gfp::Gfp([
            11250488846250692436,
            4656389213572280514,
            6165449088406407133,
            8950588588633063606,
        ])
    );
}

pub fn test_gfp_sub() {
    let a = gfp::Gfp([
        11250488846250692438,
        4656389213572280514,
        8950588588633063607,
        123,
    ]);
    let b = gfp::Gfp([
        1755467536201717349,
        17175472035685840286,
        213721987,
        10355184993929758713,
    ]);

    let c = a - b;

    assert_eq!(
        c,
        gfp::Gfp([
            11250488846250692440,
            4656389213572280514,
            2785139500226656597,
            124
        ])
    );
}

pub fn test_gfp_sub_with_carry() {
    let a = gfp::Gfp([
        12914221971125705348,
        16869266043372738742,
        2352150371692796467,
        6148399054240367173,
    ]);
    let b = gfp::Gfp([
        1750705067395732211,
        14145462954298357320,
        10130208651646123803,
        11833318026314460232,
    ]);

    let c = a - b;

    assert_eq!(
        c,
        gfp::Gfp([
            12918984439931690488,
            1452531051050670092,
            4503236705563539258,
            4670266021855665654
        ])
    );
}

pub fn test_gfp_neg() {
    let a = gfp::Gfp([
        11250488846250692438,
        4656389213572280514,
        8950588588633063607,
        123,
    ]);
    let b = gfp::Gfp([
        1755467536201717349,
        17175472035685840286,
        213721987,
        10355184993929758713,
    ]);

    assert_eq!(
        (-a),
        gfp::Gfp([
            8951722763660576529,
            12519082822113559771,
            3330706396883802986,
            10355184993929758590
        ])
    );

    assert_eq!((-b), gfp::Gfp([2, 0, 12281294985303144606, 0]));
}

pub fn test_gfp_invert() {
    let mut a = gfp::Gfp([
        11250488846250692438,
        4656389213572280514,
        8950588588633063607,
        123,
    ]);
    a.invert();

    assert_eq!(
        a,
        gfp::Gfp([
            5773649162373703676,
            376681799751688925,
            2825795984682414485,
            9194822151192441938
        ])
    );
}

// pub fn test_gfp_sqrt() {
// let mut b = gfp::Gfp([
// 1755467536201717349,
// 17175472035685840286,
// 213721987,
// 10355184993929758713,
// ]);
// b.sqrt();
//
// assert_eq!(
// b,
// gfp::Gfp([
// 16445677904934073556,
// 4460622770300838374,
// 15941605659616619718,
// 2666621848948930475
// ])
// );
// }

pub fn test_gfp_mont_encode_decode() {
    let mut c = [gfp::Gfp([
        16445677904934073556,
        4460622770300838374,
        15941605659616619718,
        2666621848948930475,
    ])];
    let mut c2 = c.clone();

    gfp::mont_encode(&mut c);
    assert_eq!(
        c[0],
        gfp::Gfp([
            9624780884217287538,
            5996517144107171957,
            5822160666522832865,
            5212132491394613704
        ])
    );

    gfp::mont_decode(&mut c2);
    assert_eq!(
        c2[0],
        gfp::Gfp([
            10658238715199466746,
            1200261570185971627,
            16649185520430610962,
            10253963333291830384
        ])
    );
}

pub fn test_gfp_mont_encode2() {
    let mut arr = [
        gfp::Gfp([
            15938733174918758233,
            9367390100531291748,
            4990504602393712947,
            2050905223688309689,
        ]),
        gfp::Gfp([
            16455197578500960065,
            18194994762483356308,
            359974064391423813,
            3473644381325915106,
        ]),
    ];

    gfp::mont_encode(&mut arr);
    assert_eq!(
        arr,
        [
            gfp::Gfp([
                6504032035804542815,
                5264472210076756907,
                1239651941983054904,
                1138563809984830267
            ]),
            gfp::Gfp([
                890546223449904040,
                9892830108785282548,
                11926666023909843271,
                861655739852933693
            ]),
        ],
    );
}

pub fn test_gfp2_conjugate() {
    let mut b = gfp2::Gfp2([
        gfp::Gfp([
            11250488846250692438,
            4656389213572280514,
            8950588588633063607,
            123,
        ]),
        gfp::Gfp([
            1755467536201717349,
            17175472035685840286,
            213721987,
            10355184993929758713,
        ]),
    ]);
    b.conjugate();
    assert_eq!(
        b,
        gfp2::Gfp2([
            gfp::Gfp([
                8951722763660576529,
                12519082822113559771,
                3330706396883802986,
                10355184993929758590
            ]),
            gfp::Gfp([
                1755467536201717349,
                17175472035685840286,
                213721987,
                10355184993929758713
            ]),
        ])
    )
}

pub fn test_gfp2_mul() {
    let mut a = gfp2::Gfp2([
        gfp::Gfp([123123123, 432432523, 12343432423, 5234543534]),
        gfp::Gfp([
            16045690984833335023,
            188899839028173,
            72057594037927935,
            320263130583841,
        ]),
    ]);
    let b = gfp2::Gfp2([
        gfp::Gfp([
            11250488846250692438,
            4656389213572280514,
            8950588588633063607,
            123,
        ]),
        gfp::Gfp([
            1755467536201717349,
            17175472035685840286,
            213721987,
            10355184993929758713,
        ]),
    ]);
    a.mul_ref(&b);
    assert_eq!(
        a,
        gfp2::Gfp2([
            gfp::Gfp([
                2489387057500270750,
                1327558915820720488,
                14258554181724279548,
                7728970882490758084
            ]),
            gfp::Gfp([
                16350727825498422601,
                9698509411976742198,
                13143318885643114834,
                8969178055545188830
            ]),
        ])
    )
}

pub fn test_gfp2_mul_scalar() {
    let mut a = gfp2::Gfp2([
        gfp::Gfp([123123123, 432432523, 12343432423, 5234543534]),
        gfp::Gfp([
            16045690984833335023,
            188899839028173,
            72057594037927935,
            320263130583841,
        ]),
    ]);
    let b = gfp2::Gfp2([
        gfp::Gfp([
            11250488846250692438,
            4656389213572280514,
            8950588588633063607,
            123,
        ]),
        gfp::Gfp([
            1755467536201717349,
            17175472035685840286,
            213721987,
            10355184993929758713,
        ]),
    ]);
    a.mul_scalar(b.x());
    assert_eq!(
        a,
        gfp2::Gfp2([
            gfp::Gfp([
                14721675226523201950,
                18190855699907848119,
                10139236777107793065,
                8752730092639463160
            ]),
            gfp::Gfp([
                10210682578032766731,
                591857751552811498,
                14628815490910629706,
                6936890750848109067
            ]),
        ])
    )
}

pub fn test_gfp2_mul_xi() {
    let mut a = gfp2::Gfp2([
        gfp::Gfp([123123123, 432432523, 12343432423, 5234543534]),
        gfp::Gfp([
            16045690984833335023,
            188899839028173,
            72057594037927935,
            320263130583841,
        ]),
    ]);
    a.mul_xi();
    assert_eq!(
        a,
        gfp2::Gfp2([
            gfp::Gfp([
                16045690985202704392,
                188901136325742,
                72057631068225204,
                320278834214443
            ]),
            gfp::Gfp([
                11243584806957778714,
                566699084651998,
                216172769770351382,
                960784157207989
            ]),
        ])
    )
}

pub fn test_gfp2_square() {
    let mut a = gfp2::Gfp2([
        gfp::Gfp([123123123, 432432523, 12343432423, 5234543534]),
        gfp::Gfp([
            16045690984833335023,
            188899839028173,
            72057594037927935,
            320263130583841,
        ]),
    ]);
    a.square();
    assert_eq!(
        a,
        gfp2::Gfp2([
            gfp::Gfp([
                11531738038236630210,
                13126667805834787204,
                18112355732282690172,
                2273042299983030315
            ]),
            gfp::Gfp([
                7110594916861888900,
                4154062045572080677,
                10875259129568976175,
                5353020417179791541
            ]),
        ])
    )
}

pub fn test_gfp2_invert() {
    let mut a = gfp2::Gfp2([
        gfp::Gfp([123123123, 432432523, 12343432423, 5234543534]),
        gfp::Gfp([
            16045690984833335023,
            188899839028173,
            72057594037927935,
            320263130583841,
        ]),
    ]);
    a.invert();
    assert_eq!(
        a,
        gfp2::Gfp2([
            gfp::Gfp([
                3911113778245031709,
                16268145991669920417,
                16013053519776358408,
                66489236252843360
            ]),
            gfp::Gfp([
                8539473088330600381,
                15068154429679669105,
                5918236881039899774,
                6959643544030151944
            ]),
        ])
    );
}

pub fn test_gfp6_mul() {
    let mut a = gfp6::Gfp6([
        gfp2::Gfp2([
            gfp::Gfp([
                13299466320820322921,
                1334898321389508150,
                777638192576573,
                2462001644565870981,
            ]),
            gfp::Gfp([
                6178297660766082928,
                6935407640177199,
                994915640430261047,
                9610997237968299987,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                10235539899642369522,
                12741543848394976843,
                2570526805555943005,
                7178211257522399554,
            ]),
            gfp::Gfp([
                8385329653617091970,
                4658593967506428941,
                7397673696024808282,
                10215112591710322060,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                17555722496412720078,
                7611710049214149191,
                9429613433644166354,
                12877982462025580053,
            ]),
            gfp::Gfp([
                9195465710963449424,
                5119449261756289138,
                4129100919611997905,
                15613499668096370617,
            ]),
        ]),
    ]);
    let b = gfp6::Gfp6([
        gfp2::Gfp2([
            gfp::Gfp([
                1251516497924237659,
                8800572147407667607,
                16894469218369778120,
                2201283438199553284,
            ]),
            gfp::Gfp([
                7385237905993026785,
                9664522640730925348,
                4949129250769697840,
                15765341227729135176,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                10790664886325667451,
                4954645195844557409,
                4872797328446812687,
                18415687177023613778,
            ]),
            gfp::Gfp([
                1100268829278832980,
                11295635979670006245,
                2531060017928703546,
                693690534599138220,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                3282165258555545034,
                12297410556422710010,
                11436677084181775060,
                594813352432006914,
            ]),
            gfp::Gfp([
                14552417674827158111,
                5666874473208417209,
                15164209493867543632,
                14869847932673707334,
            ]),
        ]),
    ]);
    a.mul_ref(&b);
    assert_eq!(
        a,
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    11250023141042085337,
                    8164665131851436433,
                    4237901628673596059,
                    2597336722362054735
                ]),
                gfp::Gfp([
                    17848783536020225926,
                    16823195710109576046,
                    7971232726808812427,
                    182986990994140376
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    9894692318664580025,
                    8676310028740166243,
                    18387579812175980292,
                    8536163994985583961
                ]),
                gfp::Gfp([
                    17914707192985647523,
                    17522501282041289216,
                    4135469977621712572,
                    1742338172306569816
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    2302682184198593166,
                    13504791764439463528,
                    17326728935197664395,
                    1001428737599459846
                ]),
                gfp::Gfp([
                    11913370879433313614,
                    9637933627311996513,
                    4474444391886026868,
                    4489855072906659958
                ]),
            ]),
        ]),
    )
}

pub fn test_gfp6_add() {
    let mut a = gfp6::Gfp6([
        gfp2::Gfp2([
            gfp::Gfp([
                13299466320820322921,
                1334898321389508150,
                777638192576573,
                2462001644565870981,
            ]),
            gfp::Gfp([
                6178297660766082928,
                6935407640177199,
                994915640430261047,
                9610997237968299987,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                10235539899642369522,
                12741543848394976843,
                2570526805555943005,
                7178211257522399554,
            ]),
            gfp::Gfp([
                8385329653617091970,
                4658593967506428941,
                7397673696024808282,
                10215112591710322060,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                17555722496412720078,
                7611710049214149191,
                9429613433644166354,
                12877982462025580053,
            ]),
            gfp::Gfp([
                9195465710963449424,
                5119449261756289138,
                4129100919611997905,
                15613499668096370617,
            ]),
        ]),
    ]);
    let b = gfp6::Gfp6([
        gfp2::Gfp2([
            gfp::Gfp([
                1251516497924237659,
                8800572147407667607,
                16894469218369778120,
                2201283438199553284,
            ]),
            gfp::Gfp([
                7385237905993026785,
                9664522640730925348,
                4949129250769697840,
                15765341227729135176,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                10790664886325667451,
                4954645195844557409,
                4872797328446812687,
                18415687177023613778,
            ]),
            gfp::Gfp([
                1100268829278832980,
                11295635979670006245,
                2531060017928703546,
                693690534599138220,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                3282165258555545034,
                12297410556422710010,
                11436677084181775060,
                594813352432006914,
            ]),
            gfp::Gfp([
                14552417674827158111,
                5666874473208417209,
                15164209493867543632,
                14869847932673707334,
            ]),
        ]),
    ]);
    a.add_ref(&b);
    assert_eq!(
        a,
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    14550982818744560580,
                    10135470468797175757,
                    16895246856562354693,
                    4663285082765424265
                ]),
                gfp::Gfp([
                    11808068030557392362,
                    10942730086394813877,
                    12109493979392643909,
                    15021153471767676449
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    823993176056768006,
                    520717008553693967,
                    13608773222195440715,
                    15238713440616254618
                ]),
                gfp::Gfp([
                    7730130946694207599,
                    17225501985200146516,
                    16094182802146196850,
                    553618132379701566
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    635676145056996145,
                    2733648569951018916,
                    8584995532309074821,
                    3117610820527828254
                ]),
                gfp::Gfp([
                    3545671775879338568,
                    12057595772988417678,
                    7012015427962674943,
                    1681418533130767622
                ]),
            ]),
        ]),
    )
}

pub fn test_gfp6_mul_tau() {
    let mut a = gfp6::Gfp6([
        gfp2::Gfp2([
            gfp::Gfp([
                13299466320820322921,
                1334898321389508150,
                777638192576573,
                2462001644565870981,
            ]),
            gfp::Gfp([
                6178297660766082928,
                6935407640177199,
                994915640430261047,
                9610997237968299987,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                10235539899642369522,
                12741543848394976843,
                2570526805555943005,
                7178211257522399554,
            ]),
            gfp::Gfp([
                8385329653617091970,
                4658593967506428941,
                7397673696024808282,
                10215112591710322060,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                17555722496412720078,
                7611710049214149191,
                9429613433644166354,
                12877982462025580053,
            ]),
            gfp::Gfp([
                9195465710963449424,
                5119449261756289138,
                4129100919611997905,
                15613499668096370617,
            ]),
        ]),
    ]);
    a.mul_tau();
    assert_eq!(
        a,
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    10235539899642369522,
                    12741543848394976843,
                    2570526805555943005,
                    7178211257522399554
                ]),
                gfp::Gfp([
                    8385329653617091970,
                    4658593967506428941,
                    7397673696024808282,
                    10215112591710322060
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    17555722496412720078,
                    7611710049214149191,
                    9429613433644166354,
                    12877982462025580053
                ]),
                gfp::Gfp([
                    9195465710963449424,
                    5119449261756289138,
                    4129100919611997905,
                    15613499668096370617
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    7427740939606231108,
                    5282902409832412981,
                    7162697643200675788,
                    6641817177736154216
                ]),
                gfp::Gfp([
                    1724491589074491161,
                    1228451977578446107,
                    15314867459483576612,
                    5660620081479511552
                ]),
            ]),
        ]),
    )
}

pub fn test_gfp6_frobenius() {
    let a = gfp6::Gfp6([
        gfp2::Gfp2([
            gfp::Gfp([
                13299466320820322921,
                1334898321389508150,
                777638192576573,
                2462001644565870981,
            ]),
            gfp::Gfp([
                6178297660766082928,
                6935407640177199,
                994915640430261047,
                9610997237968299987,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                10235539899642369522,
                12741543848394976843,
                2570526805555943005,
                7178211257522399554,
            ]),
            gfp::Gfp([
                8385329653617091970,
                4658593967506428941,
                7397673696024808282,
                10215112591710322060,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                17555722496412720078,
                7611710049214149191,
                9429613433644166354,
                12877982462025580053,
            ]),
            gfp::Gfp([
                9195465710963449424,
                5119449261756289138,
                4129100919611997905,
                15613499668096370617,
            ]),
        ]),
    ]);

    let mut b = a.clone();
    b.frobenius();
    assert_eq!(
        b,
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    9486454764309019532,
                    15153722087040825797,
                    14148130962263916270,
                    9766789264927033992
                ]),
                gfp::Gfp([
                    13825501170980227946,
                    14191973401669480257,
                    6577473672838478977,
                    7535298712779835580
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    10604673199905043352,
                    4048006646768974666,
                    12580038342680802998,
                    6356288891102824263
                ]),
                gfp::Gfp([
                    8341407740215589966,
                    2012167331039729841,
                    4066038874610911575,
                    2368225386989106381
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    891021577296831538,
                    10835034024495402424,
                    9017130640065385261,
                    5568761611683971562
                ]),
                gfp::Gfp([
                    9195465710963449424,
                    5119449261756289138,
                    4129100919611997905,
                    15613499668096370617
                ]),
            ]),
        ]),
    );

    let mut b = a.clone();
    b.frobenius_p2();
    assert_eq!(
        b,
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    671355457934989443,
                    5640316228974086885,
                    5675934534301149227,
                    5162272224294475370
                ]),
                gfp::Gfp([
                    2210863133664432197,
                    11694897798834615665,
                    16764050774757246121,
                    1749759953746667953
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    17893870032509732352,
                    16193188582259353659,
                    1955174483545948995,
                    7957384075146779003
                ]),
                gfp::Gfp([
                    10347084670917460318,
                    975262961153909817,
                    7323505486685457515,
                    4523693076367985786
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    17555722496412720078,
                    7611710049214149191,
                    9429613433644166354,
                    12877982462025580053
                ]),
                gfp::Gfp([
                    9195465710963449424,
                    5119449261756289138,
                    4129100919611997905,
                    15613499668096370617
                ])
            ])
        ]),
    );

    let mut b = a.clone();
    b.frobenius_p4();
    assert_eq!(
        b,
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    6231389831155956603,
                    10200257485322245250,
                    6604582813023140793,
                    2730911125069412362
                ]),
                gfp::Gfp([
                    13568518351682471193,
                    4202366791187336091,
                    6803623555846226019,
                    9349612796144549486
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    12275013287670436060,
                    5416211640717350068,
                    1590144608222289570,
                    5574774655190338870
                ]),
                gfp::Gfp([
                    3225264821578434030,
                    10270343069001790197,
                    9841410788323467390,
                    5971564319781209580
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    17555722496412720078,
                    7611710049214149191,
                    9429613433644166354,
                    12877982462025580053
                ]),
                gfp::Gfp([
                    9195465710963449424,
                    5119449261756289138,
                    4129100919611997905,
                    15613499668096370617
                ])
            ])
        ]),
    );
}

pub fn test_gfp6_square() {
    let mut a = gfp6::Gfp6([
        gfp2::Gfp2([
            gfp::Gfp([
                13299466320820322921,
                1334898321389508150,
                777638192576573,
                2462001644565870981,
            ]),
            gfp::Gfp([
                6178297660766082928,
                6935407640177199,
                994915640430261047,
                9610997237968299987,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                10235539899642369522,
                12741543848394976843,
                2570526805555943005,
                7178211257522399554,
            ]),
            gfp::Gfp([
                8385329653617091970,
                4658593967506428941,
                7397673696024808282,
                10215112591710322060,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                17555722496412720078,
                7611710049214149191,
                9429613433644166354,
                12877982462025580053,
            ]),
            gfp::Gfp([
                9195465710963449424,
                5119449261756289138,
                4129100919611997905,
                15613499668096370617,
            ]),
        ]),
    ]);
    a.square();
    assert_eq!(
        a,
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    1625878822368296212,
                    7137752418852243982,
                    7852957785461502495,
                    7369034017538948284
                ]),
                gfp::Gfp([
                    14259755805398656720,
                    9845563553125731804,
                    7575013111229715700,
                    9246172451541013788
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    8615873930212783731,
                    16049024658177027544,
                    3438286798177779660,
                    2819070065053580653
                ]),
                gfp::Gfp([
                    5992994943314345619,
                    702908699682906562,
                    674728541751200454,
                    2894939989035206828
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    9045448392753589614,
                    11317548171030416388,
                    13664940548098455938,
                    5537277176179613232
                ]),
                gfp::Gfp([
                    18331098019258749780,
                    4302773911054862658,
                    9263938645333819930,
                    10001562297875888661
                ])
            ])
        ]),
    )
}

pub fn test_gfp6_invert() {
    let mut a = gfp6::Gfp6([
        gfp2::Gfp2([
            gfp::Gfp([
                13299466320820322921,
                1334898321389508150,
                777638192576573,
                2462001644565870981,
            ]),
            gfp::Gfp([
                6178297660766082928,
                6935407640177199,
                994915640430261047,
                9610997237968299987,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                10235539899642369522,
                12741543848394976843,
                2570526805555943005,
                7178211257522399554,
            ]),
            gfp::Gfp([
                8385329653617091970,
                4658593967506428941,
                7397673696024808282,
                10215112591710322060,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                17555722496412720078,
                7611710049214149191,
                9429613433644166354,
                12877982462025580053,
            ]),
            gfp::Gfp([
                9195465710963449424,
                5119449261756289138,
                4129100919611997905,
                15613499668096370617,
            ]),
        ]),
    ]);
    a.invert();
    assert_eq!(
        a,
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    3618770177939589780,
                    8954217812839919346,
                    14725093990967079947,
                    494515057757056009
                ]),
                gfp::Gfp([
                    9169902377195679024,
                    10714198027339945674,
                    7350331450767891164,
                    8517253350348643059
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    2384633948016454087,
                    15887189693557135927,
                    8650595963873417222,
                    7236448062565438870
                ]),
                gfp::Gfp([
                    17654211289079118180,
                    13892215106504858285,
                    14059897362215882305,
                    6201997492044943516
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    15872923883347334976,
                    18250961755378066424,
                    7766166681217046917,
                    7740187268675792967
                ]),
                gfp::Gfp([
                    2284786759662035730,
                    18083933148000867853,
                    1245953157564280853,
                    6345153681553111422
                ])
            ])
        ]),
    )
}

pub fn test_gfp12_mul() {
    let mut a = gfp12::Gfp12([
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    3667846507953887491,
                    16900179788401734972,
                    5202994304093473423,
                    17453539537035408087,
                ]),
                gfp::Gfp([
                    11294849722977086672,
                    6931524454484542999,
                    2919019974606421381,
                    5311781127872492101,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    4588638555648059472,
                    6694620551933342411,
                    14222704463299368988,
                    6283919428323601606,
                ]),
                gfp::Gfp([
                    16935097361277382215,
                    10934062136797373527,
                    13782524259185360576,
                    6099150221451844182,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    16328742311309392122,
                    10884420952720279826,
                    5776584962314197930,
                    2625270159525647960,
                ]),
                gfp::Gfp([
                    1433550955996912027,
                    18308888180603395900,
                    7140845094312883963,
                    12322709745785911983,
                ]),
            ]),
        ]),
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    12958361953211441767,
                    16539242936560925112,
                    496667524947962939,
                    7318576673493474856,
                ]),
                gfp::Gfp([
                    10476768389383674531,
                    6622471593605249540,
                    10868377492823851870,
                    4734272502313788277,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    16513736411768867909,
                    6752337739347602576,
                    7692284702896389678,
                    6427906310226029860,
                ]),
                gfp::Gfp([
                    11804159439800973761,
                    6545976662818114017,
                    16407889771506200374,
                    6607950436195618721,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    12718068223665550407,
                    17958154591785256186,
                    9808583071101047895,
                    17976942195457119028,
                ]),
                gfp::Gfp([
                    11592890871196578403,
                    49657635944967790,
                    6201219735826930191,
                    16748731094003577462,
                ]),
            ]),
        ]),
    ]);
    let b = gfp12::Gfp12([
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    4503791523885574738,
                    12714759677392939410,
                    16457109345378546204,
                    9171162923222403663,
                ]),
                gfp::Gfp([
                    6969123563248190217,
                    2197926471184818775,
                    10290551532855509325,
                    7770597100190585264,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    10369492585103489498,
                    9424549262311352164,
                    4701824735683997277,
                    4263976124659630181,
                ]),
                gfp::Gfp([
                    1569754957210513865,
                    106637851768697756,
                    14648840659876738437,
                    6619828509513455733,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    10164860806937296078,
                    428966593719761762,
                    16600637139761291264,
                    5787507821847875483,
                ]),
                gfp::Gfp([
                    12951650004466072273,
                    9550678619841911114,
                    2421366227307746036,
                    9381991486618438145,
                ]),
            ]),
        ]),
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    1232719219505160689,
                    10176903086272498909,
                    8270979242875895831,
                    4772035228700622700,
                ]),
                gfp::Gfp([
                    794178126965929656,
                    8198588332493935106,
                    2272301894777342892,
                    5459079826449810529,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    15634252570378219707,
                    1747853453109060151,
                    13692393608475207339,
                    15299512762118938020,
                ]),
                gfp::Gfp([
                    3420540247969666996,
                    1142833676285372995,
                    16412396317541896942,
                    431962668864690761,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    5024920917484813592,
                    3889787077705029890,
                    6030945393400361870,
                    4882525774182598802,
                ]),
                gfp::Gfp([
                    2365836809404620536,
                    2497223594188346976,
                    2037307941431156442,
                    1816799884863874525,
                ]),
            ]),
        ]),
    ]);

    a.mul_ref(&b);

    assert_eq!(
        a,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        8366288660281840694,
                        17106108931172739834,
                        6474746686240165220,
                        3595716162521594081
                    ]),
                    gfp::Gfp([
                        3888116874868250365,
                        2319634497006608443,
                        16355340153066809673,
                        9316749277605971462
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        821701444971335034,
                        387935053033751094,
                        10530101431840072275,
                        6192720512623185842
                    ]),
                    gfp::Gfp([
                        8770150287726956535,
                        5984454816086749899,
                        9702674870292846421,
                        3730422798055319111
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        7969688685467800334,
                        13873377714099112324,
                        4473088674756021009,
                        5637342244435887236
                    ]),
                    gfp::Gfp([
                        5212754229807570039,
                        5080894109340452647,
                        6407798718385362255,
                        7489333360971400700
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        11771724307473966634,
                        5337740371395798810,
                        3828832192875907768,
                        9183939536668641680
                    ]),
                    gfp::Gfp([
                        8836527425709707481,
                        1361654467792037882,
                        14586974585011993760,
                        687694912754996
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        15568034726880053376,
                        1155880020925750283,
                        7273274371831393973,
                        4994271705657926134
                    ]),
                    gfp::Gfp([
                        7796472225537412817,
                        9736824667850677113,
                        8360024178150166016,
                        4217239342809540119
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        597149532245980637,
                        7827972387253570838,
                        4383259446044489068,
                        980491848796822030
                    ]),
                    gfp::Gfp([
                        15376275190762642354,
                        553095530566742872,
                        6775953191013836301,
                        5031344844963270658
                    ])
                ])
            ])
        ]),
    );
}

pub fn test_gfp12_conjugate() {
    let mut a = gfp12::Gfp12([
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    1200738607427826595,
                    7402316604169350460,
                    7099776225306707039,
                    10844354157363405321,
                ]),
                gfp::Gfp([
                    6249849037670393245,
                    7700683037695774817,
                    1252949071294785348,
                    5497601737213329501,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    17298094099783245673,
                    3505412857988577895,
                    9984357687432652001,
                    17165074977985272380,
                ]),
                gfp::Gfp([
                    11389755620203828177,
                    18165221322631691152,
                    1186036074325123127,
                    18020646389712908453,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    17664485266894284038,
                    11800645568340375105,
                    440398395809311413,
                    2200571472482386041,
                ]),
                gfp::Gfp([
                    10832092656638174102,
                    6419334518338815225,
                    4685834323563037160,
                    10533133079932876720,
                ]),
            ]),
        ]),
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    10103022555689855733,
                    11546273070202069856,
                    9891084571862857660,
                    11458196736922730286,
                ]),
                gfp::Gfp([
                    9792355561170932498,
                    14415562811685693639,
                    14587010320354796818,
                    9559774240069771158,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    11963432835322714680,
                    901906754086167148,
                    6444514864419491413,
                    14077625491358624582,
                ]),
                gfp::Gfp([
                    9121101369151049629,
                    9366532330507142765,
                    13887954159132927882,
                    15492668455428059907,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    1157125985010399030,
                    946057778929360904,
                    2902744047494707281,
                    14878521206228668672,
                ]),
                gfp::Gfp([
                    2212574646124309250,
                    2983498739587327246,
                    12440529125600000638,
                    5475741364458216453,
                ]),
            ]),
        ]),
    ]);

    a.conjugate();

    assert_eq!(
        a,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        17246005466281725021,
                        11044427469540201155,
                        11346967848402844576,
                        7602389916346146294
                    ]),
                    gfp::Gfp([
                        13952362572240875722,
                        9474788997990065468,
                        11028345914222081245,
                        4857583256716429212
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        1148649973926305943,
                        14941331215720973720,
                        8462386386276899614,
                        1281669095724279235
                    ]),
                    gfp::Gfp([
                        7056988453505723439,
                        281522751077860463,
                        17260707999384428488,
                        426097683996643162
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        2537726343016984929,
                        5374826467345465180,
                        11840896589707555180,
                        8154613521447372672
                    ]),
                    gfp::Gfp([
                        7614651417071377514,
                        12027409555370736390,
                        13760909750146514455,
                        7913610993776674895
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        10103022555689855733,
                        11546273070202069856,
                        9891084571862857660,
                        11458196736922730286
                    ]),
                    gfp::Gfp([
                        9792355561170932498,
                        14415562811685693639,
                        14587010320354796818,
                        9559774240069771158
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        11963432835322714680,
                        901906754086167148,
                        6444514864419491413,
                        14077625491358624582
                    ]),
                    gfp::Gfp([
                        9121101369151049629,
                        9366532330507142765,
                        13887954159132927882,
                        15492668455428059907
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        1157125985010399030,
                        946057778929360904,
                        2902744047494707281,
                        14878521206228668672
                    ]),
                    gfp::Gfp([
                        2212574646124309250,
                        2983498739587327246,
                        12440529125600000638,
                        5475741364458216453
                    ])
                ])
            ])
        ]),
    );
}

pub fn test_gfp12_frobenius() {
    let a = gfp12::Gfp12([
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    2540091735491372862,
                    17939401464932813024,
                    12365716353952963942,
                    9313577543264141305,
                ]),
                gfp::Gfp([
                    3904863308781927924,
                    12954988384832204441,
                    4669090897367472481,
                    2275454918850530387,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    1089785815457616173,
                    11105381979883465698,
                    10997951161518312975,
                    18407770598658596651,
                ]),
                gfp::Gfp([
                    9775384456346270157,
                    8346895887513866421,
                    17536181360332997300,
                    15076295385300114677,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    1804954384654060828,
                    17257384206765060066,
                    16964800555754698337,
                    11921430014515052065,
                ]),
                gfp::Gfp([
                    12065189263169649665,
                    14539046561667851998,
                    16641956302536492107,
                    6857178055762742683,
                ]),
            ]),
        ]),
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    10682687792263788237,
                    11517289179412700367,
                    11366405679546733092,
                    12213298948966542199,
                ]),
                gfp::Gfp([
                    3838374172461667402,
                    6981182677937813815,
                    15634176071265621590,
                    15631487658478181990,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    3152892455745523300,
                    15201925863840175490,
                    9036036148215359795,
                    9420091586457351520,
                ]),
                gfp::Gfp([
                    3449635502369493814,
                    11385008056092574830,
                    14978820178428276186,
                    1424520853186285229,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    5213332717486975346,
                    10162979714695309299,
                    2115577493997682713,
                    3990776349311192470,
                ]),
                gfp::Gfp([
                    11585592628825883278,
                    4164661155874164602,
                    3616995949541952951,
                    11867546317512717308,
                ]),
            ]),
        ]),
    ]);

    let mut b = a.clone();
    b.frobenius();

    assert_eq!(
        b,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        8699860347215723266,
                        2153477773123766431,
                        16122963214378940998,
                        5847464626378166649
                    ]),
                    gfp::Gfp([
                        18428288240250016208,
                        11587491277870081345,
                        12055501711382975061,
                        7142437294237633181
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        14429420588606402106,
                        1739092416961783202,
                        18141546886113807575,
                        10028983015434198718
                    ]),
                    gfp::Gfp([
                        2675203738517704749,
                        13969785309174461780,
                        4919666544968719388,
                        9978405027627170006
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        11572980282387206193,
                        329422984909308640,
                        9470106813241514153,
                        4333105232888603964
                    ]),
                    gfp::Gfp([
                        14940646124547152510,
                        10112052071863849365,
                        9219230943255182704,
                        498777410269012628
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        5076567446219440181,
                        3622692958915035889,
                        1591628557368894432,
                        9083153226693629356
                    ]),
                    gfp::Gfp([
                        12273114204423388510,
                        1313500879023357773,
                        5863902587488520139,
                        10348662782406924624
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        13028717029366196474,
                        199877403344351373,
                        15658791131106145466,
                        4838472579632215513
                    ]),
                    gfp::Gfp([
                        3083397889679265388,
                        14772062492456533775,
                        2996800162523628880,
                        7244888107256240611
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        14988878892424293621,
                        7012492320990530986,
                        10165717491519183880,
                        6364408644618566243
                    ]),
                    gfp::Gfp([
                        11585592628825883278,
                        4164661155874164602,
                        3616995949541952951,
                        11867546317512717308
                    ])
                ])
            ])
        ]),
    );

    let mut b = a.clone();
    b.frobenius_p2();

    assert_eq!(
        b,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        4092534151119027893,
                        4181683930478739564,
                        1462467400710877973,
                        6169415951576237512
                    ]),
                    gfp::Gfp([
                        5445318580016305769,
                        16835297996026187541,
                        8022069713272020754,
                        1069529017622440500
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        2421149256945818529,
                        4798818017778663258,
                        13564638809515420212,
                        2302599389200920775
                    ]),
                    gfp::Gfp([
                        12182294689766716161,
                        7557304110148262534,
                        7026408610700735887,
                        5634074602559402749
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        487304140416522458,
                        1766234417965256981,
                        2408974648998695994,
                        2890574061623441999
                    ]),
                    gfp::Gfp([
                        8878233024071212522,
                        11754782660792902839,
                        11646728560123135271,
                        2271954633082004765
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        15227830490183627310,
                        4634298323877440206,
                        10082068990610255285,
                        9703437750725177378
                    ]),
                    gfp::Gfp([
                        18200126467226517358,
                        10097561662603179985,
                        17886820907756209244,
                        3538266096581448830
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        12350125363209629067,
                        10424639217496083533,
                        516523898966430424,
                        1971605282918588744
                    ]),
                    gfp::Gfp([
                        9477596300640631028,
                        2030540651604346585,
                        6481069088640940925,
                        9316778913551833239
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        5213332717486975346,
                        10162979714695309299,
                        2115577493997682713,
                        3990776349311192470
                    ]),
                    gfp::Gfp([
                        11585592628825883278,
                        4164661155874164602,
                        3616995949541952951,
                        11867546317512717308
                    ])
                ])
            ])
        ]),
    );

    let mut b = a.clone();
    b.frobenius_p4();

    assert_eq!(
        b,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        3307909951829372382,
                        3417754501231766826,
                        1378046032274780624,
                        7211023402241854920
                    ]),
                    gfp::Gfp([
                        3295922807436095196,
                        2609037573170271770,
                        15634273801421414867,
                        9149259092701668826
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        17781062352965450438,
                        12376654017907177027,
                        17163400249710997997,
                        8052585604728837937
                    ]),
                    gfp::Gfp([
                        8019916920144552806,
                        9618167925537577751,
                        5254886374816130706,
                        4721110391370355964
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        437817291964178981,
                        1684322246886037201,
                        16172213152470415866,
                        1324329041038148646
                    ]),
                    gfp::Gfp([
                        17015255370812831824,
                        14391208134810891126,
                        7286067243103509757,
                        5769961571249020795
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        16249372473576839738,
                        16928084530057828667,
                        15395410286393611403,
                        9148818282097556562
                    ]),
                    gfp::Gfp([
                        18365922580134353174,
                        17272199730830686770,
                        9488337065721453968,
                        1540616232799886605
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        6454661327157833951,
                        8724378990035421548,
                        15010029923851942967,
                        9318673118483577162
                    ]),
                    gfp::Gfp([
                        9030447343102861476,
                        2488651289965207540,
                        3102700703964516076,
                        9969070221121398958
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        5213332717486975346,
                        10162979714695309299,
                        2115577493997682713,
                        3990776349311192470
                    ]),
                    gfp::Gfp([
                        11585592628825883278,
                        4164661155874164602,
                        3616995949541952951,
                        11867546317512717308
                    ])
                ])
            ])
        ]),
    );
}

pub fn test_gfp12_square() {
    let mut a = gfp12::Gfp12([
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    12013964555163908444,
                    14808224985058352287,
                    1109622207511886178,
                    2163829597263389089,
                ]),
                gfp::Gfp([
                    15462344539966982376,
                    15860511715763341453,
                    10796102638708924854,
                    9160528212763630316,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    9230553043770376978,
                    14590420944516343587,
                    3647604995917619863,
                    10661433637246210138,
                ]),
                gfp::Gfp([
                    11027707307454385488,
                    8935044016936919433,
                    1206720226933526692,
                    11119109011542323539,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    14345626474937423966,
                    4995898206283640812,
                    4727335655662835081,
                    7582985496562311864,
                ]),
                gfp::Gfp([
                    7237746903774961920,
                    10264174104393136159,
                    14057008237834512233,
                    18406957594997086400,
                ]),
            ]),
        ]),
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    14666489105234269300,
                    6479729233028719753,
                    14415648667425913570,
                    7833215564897041680,
                ]),
                gfp::Gfp([
                    15351478629902753896,
                    2675514514706354007,
                    6563202427173723264,
                    10125359277617620713,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    8228495515815198636,
                    2581152349600076717,
                    7723648549634355631,
                    14092602960836499446,
                ]),
                gfp::Gfp([
                    12219212636961089196,
                    5612519539782909016,
                    14346915990666392071,
                    12849095521220052274,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    17030197118220851176,
                    15950168293981915745,
                    3209207552624782567,
                    6138130834479014469,
                ]),
                gfp::Gfp([
                    11760264985868654620,
                    13494511671195195811,
                    1731268550352891606,
                    13004927149277904969,
                ]),
            ]),
        ]),
    ]);

    a.square();

    assert_eq!(
        a,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        17006421432967838929,
                        17427845560760317828,
                        18417609474571383702,
                        8575502755260079644
                    ]),
                    gfp::Gfp([
                        13798159589652760468,
                        2905345290307007778,
                        3153440769747253794,
                        9850820457559018786
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        7035406489789930118,
                        5019887970633007231,
                        10416650611936536874,
                        5188078490195386179
                    ]),
                    gfp::Gfp([
                        4808456183749129106,
                        12446454361756438648,
                        15733928763825820410,
                        919349344475499245
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        13581505369658051084,
                        2725902279293965176,
                        4279619295184787873,
                        8623788268271587527
                    ]),
                    gfp::Gfp([
                        16744974594390622263,
                        4691077012359608677,
                        821293552850855739,
                        9961099537659135554
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        6219776072410688521,
                        3854051837607176631,
                        14328490777669780476,
                        9278836366979810645
                    ]),
                    gfp::Gfp([
                        10494286857144740067,
                        7262731545420274421,
                        162555339361434183,
                        8369200555830661532
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        1046531506687502884,
                        13906759918862353988,
                        4038190663097413374,
                        7581444125744635397
                    ]),
                    gfp::Gfp([
                        16511446469702165860,
                        7392670263314143767,
                        9676980851712153444,
                        461819701357828537
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        17491183406219310955,
                        8402664453922682974,
                        6612389990049929711,
                        3833202121168496930
                    ]),
                    gfp::Gfp([
                        10026507007075137426,
                        2023705499039943470,
                        17646252746307055670,
                        3528382195922251337
                    ])
                ])
            ])
        ]),
    );
}

pub fn test_gfp12_set_one() {
    let mut a = gfp12::Gfp12::default();

    a.set_one();

    assert_eq!(
        a,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([gfp::Gfp([0, 0, 0, 0]), gfp::Gfp([0, 0, 0, 0])]),
                gfp2::Gfp2([gfp::Gfp([0, 0, 0, 0]), gfp::Gfp([0, 0, 0, 0])]),
                gfp2::Gfp2([gfp::Gfp([0, 0, 0, 0]), gfp::Gfp([0, 0, 0, 0])])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([gfp::Gfp([0, 0, 0, 0]), gfp::Gfp([0, 0, 0, 0])]),
                gfp2::Gfp2([gfp::Gfp([0, 0, 0, 0]), gfp::Gfp([0, 0, 0, 0])]),
                gfp2::Gfp2([
                    gfp::Gfp([0, 0, 0, 0]),
                    gfp::Gfp([
                        16691276537507834265,
                        1271272038023711329,
                        6165449088192685022,
                        8091559079779792902
                    ])
                ])
            ])
        ]),
    );
}

pub fn test_gfp12_exp() {
    let a = gfp12::Gfp12([
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    2760854596168266245,
                    410463285507609942,
                    5808811169668198877,
                    1231434299195455327,
                ]),
                gfp::Gfp([
                    12539326288993413451,
                    7230102318714495996,
                    6175423893401558442,
                    12552398646939532562,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    13847355747305046471,
                    18035394755073131576,
                    14716059516811992387,
                    17298059062978978072,
                ]),
                gfp::Gfp([
                    14814000269195625255,
                    16019272932637147212,
                    11870502691384086143,
                    1748016208695954959,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    2360485602362089510,
                    4767942490500515749,
                    1811006171205652137,
                    12805227344479373306,
                ]),
                gfp::Gfp([
                    3856970609803968254,
                    14744349334461188564,
                    3625655944335533978,
                    6362168537177977431,
                ]),
            ]),
        ]),
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    16025877046109649582,
                    9162468457068905976,
                    4754865801877286228,
                    17829856008257169458,
                ]),
                gfp::Gfp([
                    17720004535151947133,
                    7925931852233220954,
                    6369529217214369496,
                    289515257519070562,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    3316649591130426859,
                    16930025258184827104,
                    17412146179602036838,
                    8153833287786406609,
                ]),
                gfp::Gfp([
                    2993656467732856105,
                    2597052809218258109,
                    1291561376524301388,
                    7289663831724079283,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    16173192029740623481,
                    8641253715140851162,
                    11276469769874247410,
                    6736317593609620499,
                ]),
                gfp::Gfp([
                    8061985468569285658,
                    3520382789643729060,
                    15432080361893575328,
                    8031767377836413680,
                ]),
            ]),
        ]),
    ]);

    let mut b = a.clone();
    b.exp(&U.into());

    assert_eq!(
        b,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        10113851244375416064,
                        3226874029671622414,
                        16402967706007092461,
                        5597792147345149484
                    ]),
                    gfp::Gfp([
                        3053602579803778786,
                        14789590343994763386,
                        8052648266070798376,
                        8499773539004014261
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        7319170960377750419,
                        14314567967545161500,
                        7004905109391922422,
                        8343264159710318479
                    ]),
                    gfp::Gfp([
                        16478882832793586539,
                        9698958777406921786,
                        8845019632625307022,
                        7001121626709352204
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        13265100309198425445,
                        18068243522957503815,
                        9061783889011490707,
                        4445335329620169423
                    ]),
                    gfp::Gfp([
                        6526750016883697435,
                        571511299605152184,
                        207555342931363523,
                        6327988842309652592
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        1158913300529877277,
                        17934995989227947860,
                        9331338558410215326,
                        2595994460783361252
                    ]),
                    gfp::Gfp([
                        1579928687880968414,
                        16141632244579374553,
                        6831306069297138707,
                        2132897761039216118
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        5203555705926969737,
                        9311315773518228399,
                        14322339145645769535,
                        4542333360067269398
                    ]),
                    gfp::Gfp([
                        11295076250513093168,
                        10938632004894226524,
                        7073637711189887949,
                        10031535686749629114
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        3045018719230694443,
                        17655956302474818182,
                        13337545814952945385,
                        1767799073422504614
                    ]),
                    gfp::Gfp([
                        8682451205890787757,
                        11992247842612006250,
                        7267268429587149408,
                        3225716774847686340
                    ])
                ])
            ])
        ]),
    );

    let mut b = a.clone();
    b.exp(&P.into());

    assert_eq!(
        b,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        12415841162914530173,
                        15167168088220108341,
                        264242658061919211,
                        2710044584083373284
                    ]),
                    gfp::Gfp([
                        13802012258652197499,
                        7812162709302442418,
                        4616276778376756917,
                        5908261297920761280
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        1788494479564907132,
                        13695649166563084854,
                        1049714682710036925,
                        9251929991772113085
                    ]),
                    gfp::Gfp([
                        15279248311282524394,
                        3933674978049752891,
                        4014221188750686343,
                        2642252001502263505
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        16509575977507639775,
                        5652238364620594060,
                        12758390173669463386,
                        6219091984487849406
                    ]),
                    gfp::Gfp([
                        1035017084146897691,
                        7712817772480594817,
                        11520893060627367928,
                        8362263724828163001
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        495570992928569537,
                        904353314593885439,
                        10284486665229088700,
                        5876707188808050368
                    ]),
                    gfp::Gfp([
                        291132851533213838,
                        13063704878805687767,
                        16357908523288368051,
                        4201229599741390764
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        8665452317798119085,
                        17144615647318758644,
                        12413779127562706282,
                        9219305626190007659
                    ]),
                    gfp::Gfp([
                        15886302567050006221,
                        15782636696240625348,
                        1242581556547722680,
                        3789449505847271866
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        1591626703582220712,
                        16517289150593257828,
                        8211786738353609275,
                        6766158292414049320
                    ]),
                    gfp::Gfp([
                        14522332141235687355,
                        7997370115579634997,
                        12360919212190235072,
                        9182097743829469930
                    ])
                ])
            ])
        ]),
    );
}

pub fn test_gfp12_invert() {
    let mut a = gfp12::Gfp12([
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    3702521411267253021,
                    7621017602715785083,
                    10515675354853576244,
                    16061257574491263946,
                ]),
                gfp::Gfp([
                    13246403283566668357,
                    6278601434117996239,
                    8470336559517429431,
                    5165237833527017499,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    3915783333221709023,
                    9396757186147650852,
                    13571938040877398443,
                    1211123242567068557,
                ]),
                gfp::Gfp([
                    3205296117816546925,
                    573996504562857903,
                    18038155607945121651,
                    6746211784919906039,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    18321394568411648414,
                    2252990237045041341,
                    11139743789895915444,
                    4682425594689700926,
                ]),
                gfp::Gfp([
                    15577255483354407395,
                    12884731292459412005,
                    4504149958318612297,
                    14937639976797079102,
                ]),
            ]),
        ]),
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    2872765196343209357,
                    16562866521258992653,
                    11127195412902892416,
                    15930148612935619283,
                ]),
                gfp::Gfp([
                    3969876043819577967,
                    6568996827661532343,
                    3380590671303250911,
                    3645187030083852383,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    3006638927424339067,
                    10170704767908667087,
                    11327758573597514170,
                    190312375687676664,
                ]),
                gfp::Gfp([
                    11543097111886165151,
                    17650040256097916603,
                    16096266359355108837,
                    2316874018151529765,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    1750705067395732211,
                    14145462954298357320,
                    10130208651646123803,
                    11833318026314460232,
                ]),
                gfp::Gfp([
                    12914221971125705348,
                    16869266043372738742,
                    2352150371692796467,
                    6148399054240367173,
                ]),
            ]),
        ]),
    ]);

    a.invert();

    assert_eq!(
        a,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        8725530784669236444,
                        4086840915016544040,
                        11221391724010107545,
                        8365734404475279410
                    ]),
                    gfp::Gfp([
                        5191491924211732974,
                        16173759774583565755,
                        307610399190927908,
                        4056414725256850131
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        2750294504509396201,
                        15079737708157457395,
                        84372602703133142,
                        3970015652387939007
                    ]),
                    gfp::Gfp([
                        1064620314609833285,
                        12744602340600586810,
                        2484391161929600442,
                        8060842072431500363
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        10280222771389079732,
                        10927325090910148587,
                        14479014244236312671,
                        9172341407628457404
                    ]),
                    gfp::Gfp([
                        15027048458829482346,
                        10943818669861157863,
                        1284991097285655976,
                        2812257799434638677
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        14430266411514507865,
                        11160638895855157305,
                        7693658773263557990,
                        1891214393518398906
                    ]),
                    gfp::Gfp([
                        16748204535361658973,
                        4723395938016804217,
                        8667265327983459392,
                        4799142189519611722
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        2490546554527189616,
                        11113267187223846355,
                        10565395284671169651,
                        6778314741893605496
                    ]),
                    gfp::Gfp([
                        8562254502422390764,
                        12682457714982065489,
                        16487641858441271450,
                        7113881273935670330
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        11574048334820174262,
                        18162694698134431211,
                        2697903362600446380,
                        4372787533303594577
                    ]),
                    gfp::Gfp([
                        2534567728783475487,
                        1407648892423740080,
                        1611098686317639968,
                        7616619113524350704
                    ])
                ])
            ])
        ]),
    );
}

pub fn test_gfp12_final_exponentiation() {
    let mut a = gfp12::Gfp12([
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    7746766703602913940,
                    11360091731651817881,
                    614867342588151215,
                    13057466358222241307,
                ]),
                gfp::Gfp([
                    4278102385313880904,
                    1726431602035059881,
                    9291684235232712277,
                    10669372499334009279,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    17942984381384860030,
                    8265035295865313410,
                    11277804159794482514,
                    18012043940718815442,
                ]),
                gfp::Gfp([
                    6511557839754508117,
                    1734873027154322923,
                    13336621245943127009,
                    18206717104351994306,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    8808966976438088055,
                    1747251114086766858,
                    7637315157468345479,
                    12882734362385908721,
                ]),
                gfp::Gfp([
                    14624822495559609504,
                    2285424135128241092,
                    17978941597603262057,
                    18368039613021768059,
                ]),
            ]),
        ]),
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    820838582750976347,
                    26121997494692088,
                    14214361807949837977,
                    5427035684968308990,
                ]),
                gfp::Gfp([
                    2998383564885790829,
                    14926256864544452592,
                    15953336672024481204,
                    16223070253164746453,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    5149318025704139988,
                    4009019813136834896,
                    12818843079192757572,
                    18045877544016578188,
                ]),
                gfp::Gfp([
                    12682403905542053164,
                    15755813220272629588,
                    9270328695821323581,
                    10780969897608746889,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    10521933486382254155,
                    932883561855861337,
                    5772159629299006018,
                    15181848843322432853,
                ]),
                gfp::Gfp([
                    7049433074070288894,
                    207768344213459201,
                    15988219164456317273,
                    3470391652697892466,
                ]),
            ]),
        ]),
    ]);

    a.final_exponentiation();

    assert_eq!(
        a,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        1209675210185975846,
                        11603044566122610963,
                        15673510266862886728,
                        7166442817774629600
                    ]),
                    gfp::Gfp([
                        1096501857325391923,
                        1768478092178716103,
                        5467137770519099390,
                        2999129621428050299
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        15940584763415482399,
                        3513101931460257996,
                        15326547810967606640,
                        6050713642273863674
                    ]),
                    gfp::Gfp([
                        11075662083349037442,
                        9137426301727849326,
                        17986063879311810592,
                        5337575004113272640
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        7100066149093643525,
                        7510073558198035470,
                        3645941936529663754,
                        3822772998464106381
                    ]),
                    gfp::Gfp([
                        1730348902124976788,
                        3768835486770440735,
                        12481130426226118016,
                        10201337152422172443
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        18382614237176044337,
                        6524820635731445751,
                        12403212192603796761,
                        8624979402877878939
                    ]),
                    gfp::Gfp([
                        2294380990736470959,
                        13090508610506088056,
                        3466619647070115606,
                        1509456272759008284
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        12627482334354940615,
                        12977854193744533955,
                        17774385966466028836,
                        1692080156492508671
                    ]),
                    gfp::Gfp([
                        12266730357931952751,
                        3134494137666208347,
                        17735743892589984297,
                        5816724766974182460
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        2496384226233182255,
                        5757529286359966133,
                        7475972537717183871,
                        1574257112673551249
                    ]),
                    gfp::Gfp([
                        7480359146886875079,
                        7050295587122493569,
                        6638577955924591371,
                        7158615059748150193
                    ])
                ])
            ])
        ]),
    );
}

pub fn test_curve_point_add() {
    let a = CurvePoint([
        gfp::Gfp([
            11180248172986892583,
            2331717743270863324,
            12065567557781598816,
            1119039729213594194,
        ]),
        gfp::Gfp([
            15038107756621208536,
            5567772858800086314,
            13779735938699876049,
            9214642096305200921,
        ]),
        gfp::Gfp([
            16363091222776404198,
            4096995607993316186,
            8445742198371861860,
            12363724921337132914,
        ]),
        gfp::Gfp([
            14120493835551344845,
            14343971339613040267,
            8286832518748596818,
            12047442881270504813,
        ]),
    ]);
    let b = CurvePoint([
        gfp::Gfp([
            9203581560427942082,
            13071396364012365064,
            15648851985755699419,
            13279109452954083535,
        ]),
        gfp::Gfp([
            13407574962076163716,
            10263334768271872491,
            6555111850381429801,
            4595675115043250891,
        ]),
        gfp::Gfp([
            8920859680889795251,
            11886786720218018461,
            16380371313120525583,
            16722544434134905274,
        ]),
        gfp::Gfp([
            5522500594348391979,
            5741816866124341356,
            4301469826110244547,
            2820623674303704007,
        ]),
    ]);

    let mut c = CurvePoint::default();
    curve::add(&a, &b, &mut c);

    assert_eq!(
        c,
        CurvePoint([
            gfp::Gfp([
                17302884938451201800,
                11079408008183752418,
                10398672735565722612,
                3063477637636825649
            ]),
            gfp::Gfp([
                4402952141772100893,
                14921796501189703963,
                13689927131641072772,
                4590196553903926363
            ]),
            gfp::Gfp([
                11115048309543363816,
                10222907263900854775,
                16124553096489246290,
                9584441174797199031
            ]),
            gfp::Gfp([0, 0, 0, 0])
        ]),
    );
}

pub fn test_curve_point_double() {
    let a = CurvePoint([
        gfp::Gfp([
            16174427554771441791,
            10085071255883991344,
            7127972210537410976,
            13847805365842097226,
        ]),
        gfp::Gfp([
            14658630922828954844,
            4111401445125914049,
            10698873255770251247,
            15011285481371877279,
        ]),
        gfp::Gfp([
            452123965690251818,
            17485821782276778671,
            14545357089046715743,
            17420792050546468046,
        ]),
        gfp::Gfp([
            3161570244871670962,
            8795430308415009523,
            2550167391720734946,
            2761789296726153497,
        ]),
    ]);

    let mut c = CurvePoint::default();
    curve::double(&a, &mut c);

    assert_eq!(
        c,
        CurvePoint([
            gfp::Gfp([
                2212954963010105655,
                1545942943535179320,
                4137743706593440831,
                3169062876355298428
            ]),
            gfp::Gfp([
                14808711663944322350,
                2403938791754038872,
                6760041658813512830,
                823819645790184090
            ]),
            gfp::Gfp([
                6450128352784915455,
                16551685154099382574,
                4818962968471899274,
                1955489747939627859
            ]),
            gfp::Gfp([0, 0, 0, 0])
        ]),
    );
}

pub fn test_curve_make_affine() {
    let mut a = CurvePoint([
        gfp::Gfp([
            5561098924611818797,
            8670634057579230694,
            18441881587710041815,
            7004317460661018767,
        ]),
        gfp::Gfp([
            18366593772371144632,
            3520727026948574872,
            8120370431047493452,
            13744227136173407688,
        ]),
        gfp::Gfp([
            1026344654720049103,
            10097126696020769733,
            3678254104391856575,
            2765404538934575548,
        ]),
        gfp::Gfp([
            4094426062355003967,
            2614048926155007837,
            12740550433574237554,
            5179956350419398629,
        ]),
    ]);

    a.make_affine();

    assert_eq!(
        a,
        CurvePoint([
            gfp::Gfp([
                490348434721708060,
                6042746904503698424,
                15717492323376173251,
                8099891858835692911
            ]),
            gfp::Gfp([
                139911173272509547,
                1165794788561965623,
                6761959631766403874,
                5350823385729634677
            ]),
            gfp::Gfp([
                16691276537507834265,
                1271272038023711329,
                6165449088192685022,
                8091559079779792902
            ]),
            gfp::Gfp([
                16691276537507834265,
                1271272038023711329,
                6165449088192685022,
                8091559079779792902
            ])
        ]),
    );
}

pub fn test_twist_make_affine() {
    let mut a = TwistPoint([
        gfp2::Gfp2([
            gfp::Gfp([
                408637124704082518,
                5185753670135226922,
                13912940222414179646,
                9864040936778952762,
            ]),
            gfp::Gfp([
                11969598831150541427,
                5122283885826563206,
                9049220790406142763,
                15481834248395347469,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                5336837763507422160,
                15908346502932835519,
                12968418756618495328,
                5560512263471295251,
            ]),
            gfp::Gfp([
                7732687948925371938,
                9882998329005187132,
                4613226070987903268,
                7937769569131626752,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                2993352422529009552,
                17072278750452212167,
                16671868566267162455,
                12462853349301303594,
            ]),
            gfp::Gfp([
                7154519829020253406,
                3891676479132246590,
                16955849122982115163,
                16326004246007279097,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                13701270365886778727,
                2363203094931209510,
                17033928820578578001,
                8551899165211025714,
            ]),
            gfp::Gfp([
                12644828655324537486,
                9072052362200820646,
                7644950094072375243,
                2226410913446101494,
            ]),
        ]),
    ]);

    a.make_affine();

    assert_eq!(
        a,
        TwistPoint([
            gfp2::Gfp2([
                gfp::Gfp([
                    6306891522053156648,
                    13409370295220068767,
                    12173029446225877692,
                    1141093243360711627
                ]),
                gfp::Gfp([
                    9264436101671126718,
                    4705871669354949590,
                    7164011258341240407,
                    9343697075745308253
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    16639657120379080360,
                    15102422120577539418,
                    15424609773423657656,
                    6604996134227318185
                ]),
                gfp::Gfp([
                    6875009237207756521,
                    10262476233937753008,
                    16562647961800375904,
                    9325312545448153070
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([0, 0, 0, 0]),
                gfp::Gfp([
                    16691276537507834265,
                    1271272038023711329,
                    6165449088192685022,
                    8091559079779792902
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([0, 0, 0, 0]),
                gfp::Gfp([
                    16691276537507834265,
                    1271272038023711329,
                    6165449088192685022,
                    8091559079779792902
                ])
            ])
        ]),
    );
}

pub fn test_twist_double() {
    let a = TwistPoint([
        gfp2::Gfp2([
            gfp::Gfp([
                14198797066843848863,
                3392695894349432153,
                14695158110700636901,
                9229692058938098316,
            ]),
            gfp::Gfp([
                13533502829742087762,
                17294628907064251667,
                8347857427129348391,
                7587308680426855261,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                7582236859438983775,
                1782949472171560622,
                2622927197286968607,
                13815654326643572968,
            ]),
            gfp::Gfp([
                1766281705630948102,
                9161116434924619084,
                8460016426691753141,
                8501417402273542193,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                5682478691735267927,
                10586943488475783106,
                12130128847313403821,
                16079888119003407456,
            ]),
            gfp::Gfp([
                17326674003414196538,
                644132262021121341,
                7322620596780890935,
                16749590507092911867,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                4345240877168309781,
                9871801521490601511,
                5879307299003197290,
                1616779150087585905,
            ]),
            gfp::Gfp([
                7918865947147357380,
                5935831283914444534,
                14152193750909724013,
                8569552008124653129,
            ]),
        ]),
    ]);

    let mut c = TwistPoint::default();
    twist::double(&a, &mut c);

    assert_eq!(
        c,
        TwistPoint([
            gfp2::Gfp2([
                gfp::Gfp([
                    4324233320437614453,
                    5818407534679856745,
                    6719808497010356305,
                    8870487641050071281
                ]),
                gfp::Gfp([
                    15811109773054614676,
                    6598361205777808715,
                    3138568607515020677,
                    8854185184213004979
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    17903344005661545203,
                    6165482794834518234,
                    7051749711606632069,
                    8213701499690882521
                ]),
                gfp::Gfp([
                    11200154635854787249,
                    14341567311484368932,
                    7999070785035358523,
                    9332117693985078273
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    9973157648950387890,
                    4133896674802915417,
                    10446398310913487474,
                    9410072757153019019
                ]),
                gfp::Gfp([
                    10960369368895279784,
                    2757152789858621949,
                    16555244365516405916,
                    3411887694499777907
                ])
            ]),
            gfp2::Gfp2([gfp::Gfp([0, 0, 0, 0]), gfp::Gfp([0, 0, 0, 0])])
        ]),
    );
}

pub fn test_twist_add() {
    let a = TwistPoint([
        gfp2::Gfp2([
            gfp::Gfp([
                14198797066843848863,
                3392695894349432153,
                14695158110700636901,
                9229692058938098316,
            ]),
            gfp::Gfp([
                13533502829742087762,
                17294628907064251667,
                8347857427129348391,
                7587308680426855261,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                7582236859438983775,
                1782949472171560622,
                2622927197286968607,
                13815654326643572968,
            ]),
            gfp::Gfp([
                1766281705630948102,
                9161116434924619084,
                8460016426691753141,
                8501417402273542193,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                5682478691735267927,
                10586943488475783106,
                12130128847313403821,
                16079888119003407456,
            ]),
            gfp::Gfp([
                17326674003414196538,
                644132262021121341,
                7322620596780890935,
                16749590507092911867,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                4345240877168309781,
                9871801521490601511,
                5879307299003197290,
                1616779150087585905,
            ]),
            gfp::Gfp([
                7918865947147357380,
                5935831283914444534,
                14152193750909724013,
                8569552008124653129,
            ]),
        ]),
    ]);
    let b = TwistPoint([
        gfp2::Gfp2([
            gfp::Gfp([
                9203581560427942082,
                13071396364012365064,
                15648851985755699419,
                13279109452954083535,
            ]),
            gfp::Gfp([
                13407574962076163716,
                10263334768271872491,
                6555111850381429801,
                4595675115043250891,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                8920859680889795251,
                11886786720218018461,
                16380371313120525583,
                16722544434134905274,
            ]),
            gfp::Gfp([
                5522500594348391979,
                5741816866124341356,
                4301469826110244547,
                2820623674303704007,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                8464732850856978986,
                5510701068185686886,
                15299328329537409330,
                5485788079077911835,
            ]),
            gfp::Gfp([
                13942248179028497870,
                11004627612948338905,
                2668795134620908289,
                17011653763243754702,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                12703492596601947504,
                4442536882992263132,
                2077259261709480177,
                14835681267016819969,
            ]),
            gfp::Gfp([
                6159506501052699474,
                12280059960800013800,
                3157551355228025526,
                6405123810702291036,
            ]),
        ]),
    ]);

    let mut c = TwistPoint::default();
    twist::add(&a, &b, &mut c);

    assert_eq!(
        c,
        TwistPoint([
            gfp2::Gfp2([
                gfp::Gfp([
                    3768246288032467832,
                    7809054710150375496,
                    10651144623485254106,
                    500310464652063240
                ]),
                gfp::Gfp([
                    2775569271763881027,
                    9749482206039622956,
                    17888419997425004467,
                    2124693583741374793
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    2234906352550892409,
                    1728661750795963332,
                    17973626640246169821,
                    4086587213071423691
                ]),
                gfp::Gfp([
                    263927469595361257,
                    6411122505340969047,
                    859531293878624920,
                    3638474330356749153
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    171249391836521784,
                    8727511614054380365,
                    16695541677576771088,
                    4789823865919968263
                ]),
                gfp::Gfp([
                    16319303569592366403,
                    5032142507744794880,
                    10831122059924783059,
                    5623792016099844193
                ])
            ]),
            gfp2::Gfp2([gfp::Gfp([0, 0, 0, 0]), gfp::Gfp([0, 0, 0, 0])])
        ]),
    );
}

pub fn test_miller_line_function_add() {
    let r = TwistPoint([
        gfp2::Gfp2([
            gfp::Gfp([
                17999032084884497951,
                15958143346024652446,
                9896170355666933106,
                13078030476046605097,
            ]),
            gfp::Gfp([
                18333795363083054493,
                2164938603336419953,
                2690081272057840382,
                11430712481832720356,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                13133871095168060135,
                5216213308717894253,
                4098776554188119609,
                1603384592160759779,
            ]),
            gfp::Gfp([
                5426295409010652682,
                7283831622900854599,
                7817917697402574628,
                12358636228863542144,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                4938032317718056796,
                173202809412261801,
                4166965790209370399,
                3085245477228632082,
            ]),
            gfp::Gfp([
                10013843884478610999,
                17974000098081918808,
                10909300530896322225,
                13509260858974087313,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                1823495120242195692,
                6119128384251748885,
                638737647730497416,
                1515106180825643766,
            ]),
            gfp::Gfp([
                17683415990471202365,
                9024741313500479884,
                1148448480033555440,
                16272465518403075564,
            ]),
        ]),
    ]);
    let p = TwistPoint([
        gfp2::Gfp2([
            gfp::Gfp([
                2045868151349507955,
                4430741344750490000,
                16957207820434419200,
                15152082036583731667,
            ]),
            gfp::Gfp([
                8666989210662227982,
                10817301723475030014,
                17025046677304816058,
                10099932889672914854,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                17626429113251124581,
                5014465300347252333,
                11540204467708716009,
                10655457636585477645,
            ]),
            gfp::Gfp([
                4977705890001449033,
                7230630592603558509,
                6714804680073152842,
                1771091560582484380,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                7418348293746226997,
                886563866434290512,
                3408973728823101762,
                9239706534970028917,
            ]),
            gfp::Gfp([
                5063099608364498806,
                9443256222774774286,
                6951018733182467655,
                1934236441932546010,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                16397280370855839503,
                13645981795168381564,
                16485288008429847001,
                14315138339187637612,
            ]),
            gfp::Gfp([
                15540894997599284338,
                14729382442001224447,
                11109800697632130253,
                11371633241121962793,
            ]),
        ]),
    ]);
    let q = CurvePoint([
        gfp::Gfp([
            29284638186375108,
            16073505287625337234,
            8028620318269405269,
            3267855175320649157,
        ]),
        gfp::Gfp([
            3437774006813292821,
            16763661844797177991,
            7564603213058696259,
            925816324229885091,
        ]),
        gfp::Gfp([
            13952535197623812810,
            13525158448313334320,
            11972593562411886228,
            2980322911174421636,
        ]),
        gfp::Gfp([
            17327068688397803450,
            17768572326739141293,
            2433081539451846316,
            800208521741264369,
        ]),
    ]);
    let r2 = gfp2::Gfp2([
        gfp::Gfp([
            7386924349963661802,
            14075787869988330506,
            2415865670341111924,
            14578262218096549613,
        ]),
        gfp::Gfp([
            10021457685538859045,
            8987139488336776719,
            11844821987676468339,
            10863202603045503102,
        ]),
    ]);

    let (a, b, c, r_out) = line_function_add(&r, &p, &q, &r2);

    assert_eq!(
        a,
        gfp2::Gfp2([
            gfp::Gfp([
                1910873891497805933,
                12814770690294333314,
                2346723962937079064,
                10175416185764316400
            ]),
            gfp::Gfp([
                1404397971338877674,
                449584399590000908,
                6508287757384328165,
                9330002277405821996
            ])
        ]),
    );
    assert_eq!(
        b,
        gfp2::Gfp2([
            gfp::Gfp([
                8407026575705304387,
                13737044083626892333,
                6646292036187468304,
                8648262325415821759
            ]),
            gfp::Gfp([
                4394232641178334458,
                8124621584738934318,
                17228846561883761905,
                9703660836171178627
            ])
        ]),
    );
    assert_eq!(
        c,
        gfp2::Gfp2([
            gfp::Gfp([
                12922013932736833225,
                7362759299388335239,
                18387495111029806352,
                1702062916881462768
            ]),
            gfp::Gfp([
                3534163908380565254,
                982703571303395482,
                10205152489239799173,
                4028376881707691006
            ])
        ]),
    );
    assert_eq!(
        r_out,
        TwistPoint([
            gfp2::Gfp2([
                gfp::Gfp([
                    1180893809920985451,
                    15482321070704328527,
                    15168732786823942125,
                    2433131047586627097
                ]),
                gfp::Gfp([
                    17455359321044384578,
                    17038142202370972202,
                    7974067684467619281,
                    8351586025509622562
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    9184210335704793691,
                    2762803553706438086,
                    6428165991703150555,
                    1578826358201835397
                ]),
                gfp::Gfp([
                    7697949670448742090,
                    11502493244401498624,
                    17848817873105084771,
                    1645212064160106659
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    4620146817848676843,
                    5207099162829868942,
                    4373137763348444905,
                    5333502527787129726
                ]),
                gfp::Gfp([
                    3668661519102695059,
                    16836949256868085338,
                    11953315862685577285,
                    4932825862113747074
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    5258332657180605075,
                    1029065665195024802,
                    8035568116142876200,
                    7037468321484951889
                ]),
                gfp::Gfp([
                    4473220402728993030,
                    7678929613843689416,
                    7675762356266544439,
                    493267477649520856
                ])
            ])
        ]),
    );
}

pub fn test_miller_line_function_double() {
    let r = TwistPoint([
        gfp2::Gfp2([
            gfp::Gfp([
                12381603466523339604,
                12268257460338718359,
                12235904099878192164,
                9735053876693678391,
            ]),
            gfp::Gfp([
                4252651398580473032,
                14027822100414565233,
                9640750988240658420,
                4886803680217766711,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                15484902730522338210,
                2175751925171038958,
                11739585116933202733,
                2151525412696577576,
            ]),
            gfp::Gfp([
                4415693107208162845,
                7868832501719674039,
                9152241286755704365,
                4233129671468321248,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                4129689782753559570,
                3537265680876292402,
                8816310154119926540,
                18437257522583998899,
            ]),
            gfp::Gfp([
                16567848775128161412,
                8158368442548617129,
                9321671473294167368,
                4245421448383021668,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                8728135770864811505,
                9953726661296055459,
                8348942010053642173,
                9429915089351697556,
            ]),
            gfp::Gfp([
                13657366135678909427,
                15331467613707914018,
                7489650796049669167,
                6049130059678532771,
            ]),
        ]),
    ]);
    let q = CurvePoint([
        gfp::Gfp([
            9507206355570104643,
            3780152673263231440,
            8162797395613879503,
            6133914392240514523,
        ]),
        gfp::Gfp([
            6738373411653321971,
            6917256791897223533,
            14701108874623048316,
            3212310081796738598,
        ]),
        gfp::Gfp([
            16539310742065913797,
            14061470097451579904,
            9163393778653969610,
            2788626322197493576,
        ]),
        gfp::Gfp([
            12904888634742870568,
            4891201962386235198,
            17136900592811857883,
            17824259720682332739,
        ]),
    ]);

    let (a, b, c, r_out) = line_function_double(&r, &q);

    assert_eq!(
        a,
        gfp2::Gfp2([
            gfp::Gfp([
                1739136418454387138,
                2968835747579885248,
                16404296395504048157,
                1941718994115872442
            ]),
            gfp::Gfp([
                9506278516049555274,
                8291023184524782564,
                16648756451268430042,
                7489357256135983156
            ])
        ]),
    );
    assert_eq!(
        b,
        gfp2::Gfp2([
            gfp::Gfp([
                574101291012462484,
                10981082723100654103,
                15672062287771991734,
                8482109900995957756
            ]),
            gfp::Gfp([
                16545675714904074509,
                884504849531037210,
                198363049011998045,
                7271962189032181548
            ])
        ]),
    );
    assert_eq!(
        c,
        gfp2::Gfp2([
            gfp::Gfp([
                9879389762378347542,
                5734397581535445093,
                2130959074873055797,
                2373853914823428894
            ]),
            gfp::Gfp([
                3666072739243555448,
                6798999912738452046,
                16516105018828449092,
                10296425035911881927
            ])
        ]),
    );
    assert_eq!(
        r_out,
        TwistPoint([
            gfp2::Gfp2([
                gfp::Gfp([
                    16961350680626327345,
                    3081167499660041863,
                    16719443110350737342,
                    2292406611549806157
                ]),
                gfp::Gfp([
                    9274288831684213067,
                    12325101066166434348,
                    3115733036877301946,
                    4814754277158765552
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    7268167367367807014,
                    13286344115624332168,
                    1033039244841803887,
                    8094870221756672982
                ]),
                gfp::Gfp([
                    6154029614550467794,
                    10802338821559041397,
                    6838967421822632966,
                    8304052253560987329
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    2547482792562584882,
                    12087926048875806553,
                    10672174593756016218,
                    82905915324829562
                ]),
                gfp::Gfp([
                    13673401448153546694,
                    2821640096300460762,
                    13120461289973305406,
                    4391775211921890853
                ])
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    5564951371376743085,
                    16132302112580549969,
                    3552512242375221547,
                    113249591207763779
                ]),
                gfp::Gfp([
                    8235264046133443152,
                    806297219905942239,
                    14115839277312800827,
                    8068793259192784597
                ])
            ])
        ]),
    );
}

pub fn test_miller_mul_line() {
    let mut ret = gfp12::Gfp12([
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    11114815406266576086,
                    9777077227408999021,
                    7568114714018481400,
                    3913965134313896860,
                ]),
                gfp::Gfp([
                    879364893118033429,
                    17531544333764998721,
                    6862298015191337965,
                    10843945673909754550,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    4079662908850217529,
                    13434924406408936377,
                    1247719584870574081,
                    1977806395503782608,
                ]),
                gfp::Gfp([
                    13038493127299273971,
                    5992799945824405833,
                    9965304642836582646,
                    9280863892334293044,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    978916209603715119,
                    7849723074877169530,
                    12567456733140258015,
                    3626550909458782253,
                ]),
                gfp::Gfp([
                    16796408929443175099,
                    11401266874588887961,
                    377371160897552411,
                    12659159989827067954,
                ]),
            ]),
        ]),
        gfp6::Gfp6([
            gfp2::Gfp2([
                gfp::Gfp([
                    8369067405712669435,
                    12602659258424777330,
                    6289354178136045102,
                    2014147362484969368,
                ]),
                gfp::Gfp([
                    9552944838413751562,
                    14262907826462920722,
                    5397230413403245996,
                    4769098952161655511,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    15275089736969504167,
                    7125263808168400846,
                    9210957632099604832,
                    16623780356399359166,
                ]),
                gfp::Gfp([
                    5846240972496364916,
                    15425938492047051599,
                    17936104506971983844,
                    14977176221446150799,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    17218861698033272926,
                    10087742770301330297,
                    1361489339435847454,
                    8939859126313355915,
                ]),
                gfp::Gfp([
                    1879909586751715004,
                    1696963607075959855,
                    12267952273005397392,
                    13372249497487417789,
                ]),
            ]),
        ]),
    ]);
    let a = gfp2::Gfp2([
        gfp::Gfp([
            4631031965675508131,
            18140570169642576466,
            3178743840300599586,
            17033632650768434226,
        ]),
        gfp::Gfp([
            1205262541370393918,
            8649194096286634184,
            17032335237489220237,
            2831449580235784206,
        ]),
    ]);
    let b = gfp2::Gfp2([
        gfp::Gfp([
            14838822240904947265,
            4397016947119744135,
            8040124301933100157,
            4300836271093062889,
        ]),
        gfp::Gfp([
            16344693427503030527,
            3122175797205603663,
            8933615000375570260,
            409301968136297433,
        ]),
    ]);
    let c = gfp2::Gfp2([
        gfp::Gfp([
            10467758766369119225,
            18432221683229107263,
            16134371667230810265,
            5369167128525558516,
        ]),
        gfp::Gfp([
            9881080230904920745,
            14300119086869139673,
            9313232751364621174,
            11553493170532168812,
        ]),
    ]);

    mul_line(&a, &b, &c, &mut ret);

    assert_eq!(
        ret,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        7277320119145444968,
                        11037903279492921782,
                        3357067563773949600,
                        6395266714495102625
                    ]),
                    gfp::Gfp([
                        14003462087512666360,
                        10353815420729970380,
                        12896279023026976440,
                        2133025418062471174
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        401998363476523475,
                        13167288008925699022,
                        3456892355803158893,
                        8327617075416562339
                    ]),
                    gfp::Gfp([
                        1428370149876424508,
                        16597031761365840140,
                        15095935984793108998,
                        3202719166813346943
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        4567913357280571507,
                        16817155891492052156,
                        16137834728572611961,
                        2720603487054685488
                    ]),
                    gfp::Gfp([
                        15499706613465484358,
                        7005151254172050248,
                        7720859335848679532,
                        8100965657719631297
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        7347553390525142701,
                        4738947273588398037,
                        14236108588448543659,
                        1688296611739631346
                    ]),
                    gfp::Gfp([
                        12740710058815569101,
                        15813193364788494296,
                        7788220024335368895,
                        5233856045009853769
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        17582984470076664018,
                        9524739966925302548,
                        8465601261254268008,
                        10114164878882650248
                    ]),
                    gfp::Gfp([
                        17485874061483215560,
                        12546580001822114396,
                        2693803646520727689,
                        170873653150905856
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        8314597727857885912,
                        13459579862222060376,
                        4698324591180686483,
                        7292234986303525551
                    ]),
                    gfp::Gfp([
                        11408009664272035923,
                        2201802406305274076,
                        1462679479981439119,
                        524725559827965771
                    ])
                ])
            ])
        ]),
    );
}

pub fn test_miller() {
    let a = TwistPoint([
        gfp2::Gfp2([
            gfp::Gfp([
                11114815406266576086,
                9777077227408999021,
                7568114714018481400,
                3913965134313896860,
            ]),
            gfp::Gfp([
                879364893118033429,
                17531544333764998721,
                6862298015191337965,
                10843945673909754550,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                4079662908850217529,
                13434924406408936377,
                1247719584870574081,
                1977806395503782608,
            ]),
            gfp::Gfp([
                13038493127299273971,
                5992799945824405833,
                9965304642836582646,
                9280863892334293044,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                978916209603715119,
                7849723074877169530,
                12567456733140258015,
                3626550909458782253,
            ]),
            gfp::Gfp([
                16796408929443175099,
                11401266874588887961,
                377371160897552411,
                12659159989827067954,
            ]),
        ]),
        gfp2::Gfp2([
            gfp::Gfp([
                8369067405712669435,
                12602659258424777330,
                6289354178136045102,
                2014147362484969368,
            ]),
            gfp::Gfp([
                9552944838413751562,
                14262907826462920722,
                5397230413403245996,
                4769098952161655511,
            ]),
        ]),
    ]);
    let b = CurvePoint([
        gfp::Gfp([
            4631031965675508131,
            18140570169642576466,
            3178743840300599586,
            17033632650768434226,
        ]),
        gfp::Gfp([
            1205262541370393918,
            8649194096286634184,
            17032335237489220237,
            2831449580235784206,
        ]),
        gfp::Gfp([
            14078964506531013481,
            14292888393291102950,
            14000221942793148558,
            11085905251177221340,
        ]),
        gfp::Gfp([
            14399784784659935365,
            7050600547604774292,
            8511217734562027074,
            16410368890367467980,
        ]),
    ]);

    let c = miller(a, b);

    assert_eq!(
        c,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        16725011653095185009,
                        16607505076381824553,
                        8882987075663997873,
                        207283378304096206
                    ]),
                    gfp::Gfp([
                        15512234593079103820,
                        13841161717625592132,
                        2910285744266452594,
                        8022368959757788398
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        4457579077387309991,
                        7360328733353612869,
                        10332868046073196018,
                        7426183915237020754
                    ]),
                    gfp::Gfp([
                        16730664166771011658,
                        1624493911650107629,
                        6414036615660104057,
                        8704088014178597105
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        14549797328231697434,
                        8829643753389236007,
                        15489636552435891368,
                        6744052983393114572
                    ]),
                    gfp::Gfp([
                        17973788626046292233,
                        4267919334434996223,
                        12780894888411497692,
                        2219766925168570374
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        8559191797328990674,
                        13932267460150786693,
                        662318431477250233,
                        1462728386670819943
                    ]),
                    gfp::Gfp([
                        2545568203287188744,
                        5907294299044670624,
                        7251569963572095826,
                        9852738615166652507
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        6949279551312083376,
                        7032873908049744738,
                        12345900578385674243,
                        7743424233940058550
                    ]),
                    gfp::Gfp([
                        11166347862163038300,
                        10824782132460653985,
                        1436991424922182336,
                        3254893053547725556
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        1541142482515420328,
                        16886010708559344867,
                        3471472914947286361,
                        7861311623201912051
                    ]),
                    gfp::Gfp([
                        3394159922544066648,
                        2476886734660840524,
                        85568717061856264,
                        2256495691104943392
                    ])
                ])
            ])
        ]),
    );
}

pub fn test_miller_mulline2() {
    let a = gfp2::Gfp2([
        gfp::Gfp([
            16183617356268974061,
            14857407162098944039,
            4923323772516803987,
            2417012966141418326,
        ]),
        gfp::Gfp([
            3684621991425044587,
            1707610043367361815,
            26765335183090963,
            1611832168985921208,
        ]),
    ]);
    let b = gfp2::Gfp2([
        gfp::Gfp([
            17292670795326562986,
            1725712339681491161,
            6772487747946447846,
            2935296450072431207,
        ]),
        gfp::Gfp([
            13042377206814295922,
            15035415440274241534,
            17142119834494222195,
            1557169564324308928,
        ]),
    ]);
    let c = gfp2::Gfp2([
        gfp::Gfp([
            6888036494848774350,
            12915152136075576464,
            17908697212377392001,
            1332100387101839902,
        ]),
        gfp::Gfp([
            12354792945116333516,
            10325083280730902751,
            150269127345353488,
            786677004640657602,
        ]),
    ]);

    let mut ret = gfp12::Gfp12([
        gfp6::Gfp6([
            gfp2::Gfp2([gfp::Gfp([0, 0, 0, 0]), gfp::Gfp([0, 0, 0, 0])]),
            gfp2::Gfp2([
                gfp::Gfp([
                    8944024916526102868,
                    106852266696564005,
                    17801802474886537770,
                    288542707584772937,
                ]),
                gfp::Gfp([
                    11850181349292678810,
                    2457456014461268022,
                    15317925823476490280,
                    577099944750977416,
                ]),
            ]),
            gfp2::Gfp2([
                gfp::Gfp([
                    315768134599103573,
                    6181458562206075940,
                    12480030146885856993,
                    1461131275353266705,
                ]),
                gfp::Gfp([
                    17741680410343460044,
                    10019209783227599649,
                    14273755437047773688,
                    2050663518159707440,
                ]),
            ]),
        ]),
        gfp6::Gfp6([
            gfp2::Gfp2([gfp::Gfp([0, 0, 0, 0]), gfp::Gfp([0, 0, 0, 0])]),
            gfp2::Gfp2([gfp::Gfp([0, 0, 0, 0]), gfp::Gfp([0, 0, 0, 0])]),
            gfp2::Gfp2([
                gfp::Gfp([
                    4095557238897089039,
                    8001731380751689688,
                    6570934570935402985,
                    2942064087001579045,
                ]),
                gfp::Gfp([
                    1107676101453997059,
                    13098540100063850086,
                    2148651353789215255,
                    2630797746516312413,
                ]),
            ]),
        ]),
    ]);

    mul_line(&a, &b, &c, &mut ret);

    assert_eq!(
        ret,
        gfp12::Gfp12([
            gfp6::Gfp6([
                gfp2::Gfp2([gfp::Gfp([0, 0, 0, 0]), gfp::Gfp([0, 0, 0, 0])]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        10118416828098028218,
                        15089843957213435180,
                        8534947713794802728,
                        2396630694064242626
                    ]),
                    gfp::Gfp([
                        17376271468049172104,
                        6843886073962883694,
                        7090749432654383460,
                        602785332460185660
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        6146670744291913050,
                        9374023094873028602,
                        3898166989105990436,
                        90300435101188752
                    ]),
                    gfp::Gfp([
                        1755414355363533510,
                        8582933548706153068,
                        2718099470890804599,
                        1311324479362608127
                    ])
                ])
            ]),
            gfp6::Gfp6([
                gfp2::Gfp2([
                    gfp::Gfp([
                        2266430465389556481,
                        9566541955788479673,
                        16170643865950689177,
                        2469333769152262898
                    ]),
                    gfp::Gfp([
                        2931226946984578162,
                        17352649174043705956,
                        12809489959931521937,
                        1712012973469064868
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        4362055564336717965,
                        13801727454249533751,
                        822472346206711817,
                        3325233372571011755
                    ]),
                    gfp::Gfp([
                        550565505123631353,
                        1579490179292555686,
                        10267959845508557254,
                        1468567417667078976
                    ])
                ]),
                gfp2::Gfp2([
                    gfp::Gfp([
                        6992634680654879632,
                        13842097528383178283,
                        3799152378397697967,
                        1207422067652171580
                    ]),
                    gfp::Gfp([
                        2629081260665339645,
                        9500083259958016262,
                        1018327784856016437,
                        3106202720363406595
                    ])
                ])
            ])
        ]),
    );
}

pub fn test_mul_by_byte_index() {
    let a = [
        gfp::Gfp([
            4362055564336717965,
            13801727454249533751,
            822472346206711817,
            3325233372571011755,
        ]),
        gfp::Gfp([
            550565505123631353,
            1579490179292555686,
            10267959845508557254,
            1468567417667078976,
        ]),
    ];
    let b = [
        gfp::Gfp([
            6992634680654879632,
            13842097528383178283,
            3799152378397697967,
            1207422067652171580,
        ]),
        gfp::Gfp([
            2629081260665339645,
            9500083259958016262,
            1018327784856016437,
            3106202720363406595,
        ]),
    ];

    let mut c: [gfp::Gfp; 4] = Default::default();

    let a_index = [0, 0, 32, 32];
    let b_index = [0, 32, 0, 32];

    gfp::mul_by_byte_index(&a, &b, &a_index, &b_index, &mut c);

    assert_eq!(c[0], a[0].clone() * b[0].clone());
    assert_eq!(c[1], a[0].clone() * b[1].clone());
    assert_eq!(c[2], a[1].clone() * b[0].clone());
    assert_eq!(c[3], a[1].clone() * b[1].clone());
}

pub fn test_add_by_byte_index() {
    let a = [
        gfp::Gfp([
            4362055564336717965,
            13801727454249533751,
            822472346206711817,
            3325233372571011755,
        ]),
        gfp::Gfp([
            550565505123631353,
            1579490179292555686,
            10267959845508557254,
            1468567417667078976,
        ]),
        gfp::Gfp([
            6992634680654879632,
            13842097528383178283,
            3799152378397697967,
            1207422067652171580,
        ]),
    ];

    let mut c: [gfp::Gfp; 4] = Default::default();

    let a_index = [0, 64, 32, 32];
    let b_index = [0, 32, 0, 32];

    gfp::add_by_byte_index(&a, &a, &a_index, &b_index, &mut c);

    assert_eq!(c[0], a[0].clone() + a[0].clone());
    assert_eq!(c[1], a[2].clone() + a[1].clone());
    assert_eq!(c[2], a[1].clone() + a[0].clone());
    assert_eq!(c[3], a[1].clone() + a[1].clone());
}
